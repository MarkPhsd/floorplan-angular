import { Injectable } from '@angular/core';
import { Subject } from 'rxjs';
import * as i0 from "@angular/core";
export class AppService {
    constructor() {
        this.orderID = '';
        this.roomEdit = false;
        this.states = [];
        this.redoStates = [];
        this.roomEditOperate = 'CORNER';
        this.roomEditStates = [];
        this.roomEditRedoStates = [];
        this.selections = [];
        this.ungroupable = false;
        this.selectededObject = new Subject();
        this.setSelectedObjectColor = new Subject();
        this.selectedBackGroundImage = new Subject();
        this.performOperation = new Subject();
        this.insertObject = new Subject();
        this.defaultChair = new Subject();
        this.jsonValue = new Subject();
        this.roomEdition = new Subject();
        this.saveState = new Subject();
        this.zoom = 100;
        this.saveState.subscribe(res => {
            if (this.roomEdit) {
                this.roomEditStates.push(res);
                this.roomEditRedoStates = [];
                return;
            }
            this.states.push(res);
            this.redoStates = [];
        });
    }
    editRoom() {
        this.roomEdit = true;
        this.roomEdition.next(true);
        this.performOperation.next('enableSelection');
    }
    endEditRoom() {
        this.roomEdit = false;
        this.roomEdition.next(false);
        this.performOperation.next('disableSelection');
    }
    updateCurrentObjet() {
        this.selectededObject.subscribe(data => {
            this.currenObject = data;
        });
    }
    undo() {
        if ((this.states.length === 1 && !this.roomEdit) || (this.roomEditStates.length === 1 && this.roomEdit)) {
            return;
        }
        this.performOperation.next('UNDO');
    }
    redo() {
        if ((this.redoStates.length === 0 && !this.roomEdit) || (this.roomEditRedoStates.length === 0 && this.roomEdit)) {
            return;
        }
        this.performOperation.next('REDO');
    }
    clone() {
        this.copy(true);
    }
    copy(doClone = false) {
        this.performOperation.next('COPY');
        if (doClone) {
            setTimeout(() => this.paste(), 100);
        }
    }
    //setFillColor
    setObjectFillColor(color) {
        this.setSelectedObjectColor.next(color);
    }
    paste() {
        this.performOperation.next('PASTE');
    }
    setOrder(item) {
        if (!this.selections.length) {
            return;
        }
        this.orderID = item;
        this.performOperation.next('setOrderID');
    }
    setTable(tableName) {
        console.log(tableName, this.selections.length);
        if (!this.selections.length) {
            return;
        }
        this.performOperation.next('setTableName');
    }
    delete() {
        if (!this.selections.length) {
            return;
        }
        this.performOperation.next('DELETE');
    }
    disableSelection() {
        this.performOperation.next('disableSelection');
    }
    loadJson(value) {
        this.jsonValue.next(value);
    }
    clearLayout() {
        this.jsonValue.next(null);
        this.performOperation.next('clearLayout');
    }
    rotateAntiClockWise() {
        this.performOperation.next('ROTATE_ANTI');
    }
    rotateClockWise() {
        this.performOperation.next('ROTATE');
    }
    group() {
        this.performOperation.next('GROUP');
    }
    ungroup() {
        this.performOperation.next('UNGROUP');
    }
    placeInCenter(direction) {
        this.performOperation.next(direction);
    }
    arrange(side) {
        this.performOperation.next(side);
    }
    zoomIn() {
        if (this.zoom >= 150) {
            return;
        }
        this.zoom += 10;
        this.performOperation.next('ZOOM');
    }
    zoomOut() {
        if (this.zoom <= 20) {
            return;
        }
        this.zoom -= 10;
        this.performOperation.next('ZOOM');
    }
}
AppService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.3.4", ngImport: i0, type: AppService, deps: [], target: i0.ɵɵFactoryTarget.Injectable });
AppService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "13.3.4", ngImport: i0, type: AppService, providedIn: 'root' });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.3.4", ngImport: i0, type: AppService, decorators: [{
            type: Injectable,
            args: [{
                    providedIn: 'root'
                }]
        }], ctorParameters: function () { return []; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLnNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvYXBwL2FwcC5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLE1BQU0sQ0FBQzs7QUFTL0IsTUFBTSxPQUFPLFVBQVU7SUFvQ3JCO1FBOUJBLFlBQU8sR0FBSyxFQUFFLENBQUE7UUFJZCxhQUFRLEdBQUcsS0FBSyxDQUFDO1FBR2pCLFdBQU0sR0FBRyxFQUFFLENBQUM7UUFDWixlQUFVLEdBQUcsRUFBRSxDQUFDO1FBRWhCLG9CQUFlLEdBQUcsUUFBUSxDQUFDO1FBQzNCLG1CQUFjLEdBQUcsRUFBRSxDQUFDO1FBQ3BCLHVCQUFrQixHQUFHLEVBQUUsQ0FBQztRQUV4QixlQUFVLEdBQVUsRUFBRSxDQUFDO1FBR3ZCLGdCQUFXLEdBQUcsS0FBSyxDQUFDO1FBRXBCLHFCQUFnQixHQUFpQixJQUFJLE9BQU8sRUFBTyxDQUFDO1FBQ3BELDJCQUFzQixHQUFpQixJQUFJLE9BQU8sRUFBTyxDQUFDO1FBQzFELDRCQUF1QixHQUFpQixJQUFJLE9BQU8sRUFBTyxDQUFDO1FBQzNELHFCQUFnQixHQUFpQixJQUFJLE9BQU8sRUFBTyxDQUFDO1FBQ3BELGlCQUFZLEdBQWlCLElBQUksT0FBTyxFQUFPLENBQUM7UUFDaEQsaUJBQVksR0FBaUIsSUFBSSxPQUFPLEVBQU8sQ0FBQztRQUNoRCxjQUFTLEdBQXdCLElBQUksT0FBTyxFQUFPLENBQUM7UUFDcEQsZ0JBQVcsR0FBc0IsSUFBSSxPQUFPLEVBQVcsQ0FBQztRQUN4RCxjQUFTLEdBQUcsSUFBSSxPQUFPLEVBQU8sQ0FBQztRQUMvQixTQUFJLEdBQUcsR0FBRyxDQUFDO1FBR1QsSUFBSSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLEVBQUU7WUFDN0IsSUFB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Q0FBQyxDQUFDO0lBQ3hDLENBQUM7SUFFRCxhQUFhLENBQUMsU0FBUztRQUNyQixJQUFJLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQ3hDLENBQUM7SUFFRCxPQUFPLENBQUMsSUFBSTtRQUNWLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbkMsQ0FBQztJQUVELE1BQU07UUFDSixJQUFJLElBQUksQ0FBQyxJQUFJLElBQUksR0FBRyxFQUFFO1lBQ3BCLE9BQU87U0FDUjtRQUNELElBQUksQ0FBQyxJQUFJLElBQUksRUFBRSxDQUFDO1FBQ2hCLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDckMsQ0FBQztJQUVELE9BQU87UUFDTCxJQUFJLElBQUksQ0FBQyxJQUFJLElBQUksRUFBRSxFQUFFO1lBQ25CLE9BQU87U0FDUjtRQUNELElBQUksQ0FBQyxJQUFJLElBQUksRUFBRSxDQUFDO1FBQ2hCLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDckMsQ0FBQzs7dUdBeEtVLFVBQVU7MkdBQVYsVUFBVSxjQUZULE1BQU07MkZBRVAsVUFBVTtrQkFIdEIsVUFBVTttQkFBQztvQkFDVixVQUFVLEVBQUUsTUFBTTtpQkFDbkIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdyeGpzJztcclxuZXhwb3J0IGludGVyZmFjZSB1dWlkTGlzdCB7XHJcbiAgdXVJRDogc3RyaW5nO1xyXG4gIGNvbG9yOiBzdHJpbmc7XHJcbn1cclxuXHJcbkBJbmplY3RhYmxlKHtcclxuICBwcm92aWRlZEluOiAncm9vdCdcclxufSlcclxuZXhwb3J0IGNsYXNzIEFwcFNlcnZpY2Uge1xyXG5cclxuICAvL2lmIHRydWUgd2hlbiB0YWJsZSBpcyBzZWxlY3RlZCwgaXQncyBjbGVhcmVkJywgYW5kIHN1Ym1pdHRlZCBiYWNrIHRvXHJcbiAgLy90aGUgYXBwY29tcG9uZW50IHRvIGJlIHNhdmVkLlxyXG4gIGNsZWFyTmV4dFNlbGVjdGVkVGFibGU6IGJvb2xlYW47XHJcblxyXG4gIG9yZGVySUQgICA9ICcnXHJcbiAgdGFibGVOYW1lOiBzdHJpbmc7XHJcblxyXG4gIHRhYmxlU3RhdHVzOiBzdHJpbmc7XHJcbiAgcm9vbUVkaXQgPSBmYWxzZTtcclxuICB1c2VyTW9kZSA6IGJvb2xlYW47XHJcblxyXG4gIHN0YXRlcyA9IFtdO1xyXG4gIHJlZG9TdGF0ZXMgPSBbXTtcclxuXHJcbiAgcm9vbUVkaXRPcGVyYXRlID0gJ0NPUk5FUic7XHJcbiAgcm9vbUVkaXRTdGF0ZXMgPSBbXTtcclxuICByb29tRWRpdFJlZG9TdGF0ZXMgPSBbXTtcclxuXHJcbiAgc2VsZWN0aW9uczogYW55W10gPSBbXTtcclxuICBjb3BpZWQ6IGFueTtcclxuXHJcbiAgdW5ncm91cGFibGUgPSBmYWxzZTtcclxuICBjdXJyZW5PYmplY3QgOiBhbnk7XHJcbiAgc2VsZWN0ZWRlZE9iamVjdDogU3ViamVjdDxhbnk+ID0gbmV3IFN1YmplY3Q8YW55PigpO1xyXG4gIHNldFNlbGVjdGVkT2JqZWN0Q29sb3I6IFN1YmplY3Q8YW55PiA9IG5ldyBTdWJqZWN0PGFueT4oKTtcclxuICBzZWxlY3RlZEJhY2tHcm91bmRJbWFnZTogU3ViamVjdDxhbnk+ID0gbmV3IFN1YmplY3Q8YW55PigpO1xyXG4gIHBlcmZvcm1PcGVyYXRpb246IFN1YmplY3Q8YW55PiA9IG5ldyBTdWJqZWN0PGFueT4oKTtcclxuICBpbnNlcnRPYmplY3Q6IFN1YmplY3Q8YW55PiA9IG5ldyBTdWJqZWN0PGFueT4oKTtcclxuICBkZWZhdWx0Q2hhaXI6IFN1YmplY3Q8YW55PiA9IG5ldyBTdWJqZWN0PGFueT4oKTtcclxuICBqc29uVmFsdWU6IFN1YmplY3Q8YW55PiAgICAgICAgPSBuZXcgU3ViamVjdDxhbnk+KCk7XHJcbiAgcm9vbUVkaXRpb246IFN1YmplY3Q8Ym9vbGVhbj4gID0gbmV3IFN1YmplY3Q8Ym9vbGVhbj4oKTtcclxuICBzYXZlU3RhdGUgPSBuZXcgU3ViamVjdDxhbnk+KCk7XHJcbiAgem9vbSA9IDEwMDtcclxuXHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLnNhdmVTdGF0ZS5zdWJzY3JpYmUocmVzID0+IHtcclxuICAgICAgaWYgKHRoaXMucm9vbUVkaXQpIHtcclxuICAgICAgICB0aGlzLnJvb21FZGl0U3RhdGVzLnB1c2gocmVzKTtcclxuICAgICAgICB0aGlzLnJvb21FZGl0UmVkb1N0YXRlcyA9IFtdO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLnN0YXRlcy5wdXNoKHJlcyk7XHJcbiAgICAgIHRoaXMucmVkb1N0YXRlcyA9IFtdO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlZGl0Um9vbSgpIHtcclxuICAgIHRoaXMucm9vbUVkaXQgPSB0cnVlO1xyXG4gICAgdGhpcy5yb29tRWRpdGlvbi5uZXh0KHRydWUpO1xyXG4gICAgdGhpcy5wZXJmb3JtT3BlcmF0aW9uLm5leHQoJ2VuYWJsZVNlbGVjdGlvbicpO1xyXG4gIH1cclxuXHJcbiAgZW5kRWRpdFJvb20oKSB7XHJcbiAgICB0aGlzLnJvb21FZGl0ID0gZmFsc2U7XHJcbiAgICB0aGlzLnJvb21FZGl0aW9uLm5leHQoZmFsc2UpO1xyXG4gICAgdGhpcy5wZXJmb3JtT3BlcmF0aW9uLm5leHQoJ2Rpc2FibGVTZWxlY3Rpb24nKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUN1cnJlbnRPYmpldCgpIHtcclxuICAgIHRoaXMuc2VsZWN0ZWRlZE9iamVjdC5zdWJzY3JpYmUoZGF0YSA9PiB7XHJcbiAgICAgIHRoaXMuY3VycmVuT2JqZWN0ID0gZGF0YTtcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICB1bmRvKCkge1xyXG4gICAgaWYgKCh0aGlzLnN0YXRlcy5sZW5ndGggPT09IDEgJiYgIXRoaXMucm9vbUVkaXQpIHx8ICh0aGlzLnJvb21FZGl0U3RhdGVzLmxlbmd0aCA9PT0gMSAmJiB0aGlzLnJvb21FZGl0KSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLnBlcmZvcm1PcGVyYXRpb24ubmV4dCgnVU5ETycpO1xyXG4gIH1cclxuXHJcbiAgcmVkbygpIHtcclxuICAgIGlmICgodGhpcy5yZWRvU3RhdGVzLmxlbmd0aCA9PT0gMCAmJiAhdGhpcy5yb29tRWRpdCkgfHwgKHRoaXMucm9vbUVkaXRSZWRvU3RhdGVzLmxlbmd0aCA9PT0gMCAmJiB0aGlzLnJvb21FZGl0KSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLnBlcmZvcm1PcGVyYXRpb24ubmV4dCgnUkVETycpO1xyXG4gIH1cclxuXHJcbiAgY2xvbmUoKSB7XHJcbiAgICB0aGlzLmNvcHkodHJ1ZSk7XHJcbiAgfVxyXG5cclxuICBjb3B5KGRvQ2xvbmUgPSBmYWxzZSkge1xyXG4gICAgdGhpcy5wZXJmb3JtT3BlcmF0aW9uLm5leHQoJ0NPUFknKTtcclxuICAgIGlmIChkb0Nsb25lKSB7XHJcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5wYXN0ZSgpLCAxMDApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy9zZXRGaWxsQ29sb3JcclxuICBzZXRPYmplY3RGaWxsQ29sb3IoY29sb3I6IHN0cmluZykge1xyXG4gICAgdGhpcy5zZXRTZWxlY3RlZE9iamVjdENvbG9yLm5leHQoY29sb3IpO1xyXG4gIH1cclxuXHJcbiAgcGFzdGUoKSB7XHJcbiAgICB0aGlzLnBlcmZvcm1PcGVyYXRpb24ubmV4dCgnUEFTVEUnKTtcclxuICB9XHJcblxyXG4gIHNldE9yZGVyKGl0ZW0pIHtcclxuICAgIGlmICghdGhpcy5zZWxlY3Rpb25zLmxlbmd0aCkgeyByZXR1cm47IH1cclxuICAgIHRoaXMub3JkZXJJRCA9IGl0ZW0gO1xyXG4gICAgdGhpcy5wZXJmb3JtT3BlcmF0aW9uLm5leHQoJ3NldE9yZGVySUQnKTtcclxuICB9XHJcblxyXG4gIHNldFRhYmxlKHRhYmxlTmFtZSkge1xyXG4gICAgY29uc29sZS5sb2codGFibGVOYW1lLCB0aGlzLnNlbGVjdGlvbnMubGVuZ3RoKVxyXG4gICAgaWYgKCF0aGlzLnNlbGVjdGlvbnMubGVuZ3RoKSB7IHJldHVybjsgfVxyXG4gICAgdGhpcy5wZXJmb3JtT3BlcmF0aW9uLm5leHQoJ3NldFRhYmxlTmFtZScpO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlKCkge1xyXG4gICAgaWYgKCF0aGlzLnNlbGVjdGlvbnMubGVuZ3RoKSB7IHJldHVybjsgfVxyXG4gICAgdGhpcy5wZXJmb3JtT3BlcmF0aW9uLm5leHQoJ0RFTEVURScpO1xyXG4gIH1cclxuXHJcbiAgZGlzYWJsZVNlbGVjdGlvbigpIHtcclxuICAgIHRoaXMucGVyZm9ybU9wZXJhdGlvbi5uZXh0KCdkaXNhYmxlU2VsZWN0aW9uJyk7XHJcbiAgfVxyXG5cclxuICBsb2FkSnNvbih2YWx1ZTogc3RyaW5nKSB7XHJcbiAgICB0aGlzLmpzb25WYWx1ZS5uZXh0KHZhbHVlKTtcclxuICB9XHJcblxyXG4gIGNsZWFyTGF5b3V0KCkge1xyXG4gICAgdGhpcy5qc29uVmFsdWUubmV4dChudWxsKTtcclxuICAgIHRoaXMucGVyZm9ybU9wZXJhdGlvbi5uZXh0KCdjbGVhckxheW91dCcpXHJcbiAgfVxyXG5cclxuICByb3RhdGVBbnRpQ2xvY2tXaXNlKCkge1xyXG4gICAgdGhpcy5wZXJmb3JtT3BlcmF0aW9uLm5leHQoJ1JPVEFURV9BTlRJJyk7XHJcbiAgfVxyXG5cclxuICByb3RhdGVDbG9ja1dpc2UoKSB7XHJcbiAgICB0aGlzLnBlcmZvcm1PcGVyYXRpb24ubmV4dCgnUk9UQVRFJyk7XHJcbiAgfVxyXG5cclxuICBncm91cCgpIHtcclxuICAgIHRoaXMucGVyZm9ybU9wZXJhdGlvbi5uZXh0KCdHUk9VUCcpO1xyXG4gIH1cclxuXHJcbiAgdW5ncm91cCgpIHtcclxuICAgIHRoaXMucGVyZm9ybU9wZXJhdGlvbi5uZXh0KCdVTkdST1VQJyk7XHJcbiAgfVxyXG5cclxuICBwbGFjZUluQ2VudGVyKGRpcmVjdGlvbikge1xyXG4gICAgdGhpcy5wZXJmb3JtT3BlcmF0aW9uLm5leHQoZGlyZWN0aW9uKTtcclxuICB9XHJcblxyXG4gIGFycmFuZ2Uoc2lkZSkge1xyXG4gICAgdGhpcy5wZXJmb3JtT3BlcmF0aW9uLm5leHQoc2lkZSk7XHJcbiAgfVxyXG5cclxuICB6b29tSW4oKSB7XHJcbiAgICBpZiAodGhpcy56b29tID49IDE1MCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLnpvb20gKz0gMTA7XHJcbiAgICB0aGlzLnBlcmZvcm1PcGVyYXRpb24ubmV4dCgnWk9PTScpO1xyXG4gIH1cclxuXHJcbiAgem9vbU91dCgpIHtcclxuICAgIGlmICh0aGlzLnpvb20gPD0gMjApIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy56b29tIC09IDEwO1xyXG4gICAgdGhpcy5wZXJmb3JtT3BlcmF0aW9uLm5leHQoJ1pPT00nKTtcclxuICB9XHJcblxyXG5cclxuXHJcbn1cclxuIl19